<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animal Face Test - Dog or Cat</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4034054558626164"
     crossorigin="anonymous"></script>
    <meta name="google-adsense-account" content="ca-pub-4034054558626164">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-45D3CNZ5EV"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-45D3CNZ5EV');
    </script>
    <style>
        .animal-test-container {
            background: var(--wrapper-bg);
            padding: 40px;
            border-radius: 15px;
            box-shadow: var(--wrapper-shadow);
            width: 100%;
            max-width: 600px;
            margin-top: 50px;
            text-align: center;
        }
        .animal-test-container h1 {
            color: var(--text-color);
            margin-bottom: 30px;
        }
        #image-display {
            max-width: 100%;
            max-height: 300px;
            margin-top: 20px;
            border: 2px solid var(--text-color);
            border-radius: 10px;
            object-fit: contain;
        }
        #label-container div {
            color: var(--text-color);
            margin-top: 10px;
            font-size: 1.2em;
        }
        .animal-test-container button {
            margin-top: 20px;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: var(--button-bg);
            color: var(--text-color);
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--button-shadow);
        }
        .animal-test-container button:hover {
            background: var(--button-hover-bg);
            box-shadow: var(--button-hover-shadow);
        }
        input[type="file"] {
            margin-top: 20px;
            color: var(--text-color);
        }
    </style>
</head>
<body class="light-mode">
    <div class="animal-test-container">
        <h1>Animal Face Test</h1>
        <p style="color: var(--text-color);">Upload an image to find out if it's a dog or a cat!</p>
        <input type="file" id="imageUpload" accept="image/*">
        <img id="image-display" style="display: none;">
        <button type="button" id="predictButton" style="display: none;">Predict</button>
        <div id="label-container"></div>
    </div>

    <div class="content-section" style="max-width: 800px; margin: 40px auto; padding: 20px; background: var(--wrapper-bg); border-radius: 15px; box-shadow: var(--wrapper-shadow); color: var(--text-color); text-align: left;">
        <h2>About the Animal Face Test</h2>
        <p>This fun tool allows you to test whether an uploaded image resembles a dog or a cat! We utilize a cutting-edge machine learning model, trained with Google's Teachable Machine, to analyze facial features and provide a prediction.</p>
        <p>Our model has been carefully trained on a diverse dataset of dog and cat images to recognize patterns and characteristics unique to each animal. Simply upload a clear image of a pet's face, and our system will quickly provide an assessment.</p>
        <h3>How it Works:</h3>
        <ol>
            <li>**Upload Image:** Click on the "Choose File" button and select a clear image of a dog or cat's face from your device.</li>
            <li>**Predict:** Once the image is displayed, click the "Predict" button.</li>
            <li>**See Results:** The system will then show you the probability of the image being either a dog or a cat.</li>
        </ol>
        <p>Please note that while our model is advanced, its accuracy depends on the quality and clarity of the uploaded image. Enjoy testing your furry friends!</p>
    </div>

    <script type="text/javascript">
        const URL = "https://teachablemachine.withgoogle.com/models/o6Odif4pZ/";

        let model, labelContainer, maxPredictions;
        let imageDisplay = document.getElementById("image-display");
        let predictButton = document.getElementById("predictButton");

        async function init() {
            const modelURL = URL + "model.json";
            const metadataURL = URL + "metadata.json";

            model = await tmImage.load(modelURL, metadataURL);
            maxPredictions = model.getTotalClasses();

            labelContainer = document.getElementById("label-container");
            for (let i = 0; i < maxPredictions; i++) {
                labelContainer.appendChild(document.createElement("div"));
            }

            document.getElementById('imageUpload').addEventListener('change', handleFileSelect);
            predictButton.addEventListener('click', () => predict(imageDisplay));
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imageDisplay.src = e.target.result;
                    imageDisplay.style.display = 'block';
                    predictButton.style.display = 'block';
                };
                reader.readAsDataURL(file);
            } else {
                imageDisplay.style.display = 'none';
                predictButton.style.display = 'none';
                for (let i = 0; i < maxPredictions; i++) {
                    labelContainer.childNodes[i].innerHTML = "";
                }
            }
        }

        async function predict(imageElement) {
            if (!imageElement || imageElement.style.display === 'none') {
                return; // No image to predict
            }
            const prediction = await model.predict(imageElement);
            for (let i = 0; i < maxPredictions; i++) {
                const classPrediction =
                    prediction[i].className + ": " + prediction[i].probability.toFixed(2);
                labelContainer.childNodes[i].innerHTML = classPrediction;
            }
        }

        init(); // Initialize the model on page load
    </script>
    <script src="main.js"></script>
</body>
</html>